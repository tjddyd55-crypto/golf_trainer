<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§¤ì¥ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ - {{ store_id }} (ëŒ€ë¦¬ ì¡°íšŒ)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/store_admin.css') }}?v=2.0">
</head>
<body>
    <div class="admin-container">
        <div class="alert alert-danger mb-0" role="alert" style="border-radius: 0; position: sticky; top: 0; z-index: 1000;">
            <strong>ğŸ” ìŠˆí¼ ê´€ë¦¬ì ëŒ€ë¦¬ ì¡°íšŒ ì¤‘</strong> - ì½ê¸° ì „ìš© ëª¨ë“œì…ë‹ˆë‹¤.
            <a href="{{ url_for('super_admin_dashboard') }}" class="float-end text-white text-decoration-none">
                â† ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°
            </a>
        </div>
        <div class="admin-header">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1 class="text-white mb-0">â›³ {{ store_id }} ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
                    <span class="badge bg-warning">ìŠˆí¼ ê´€ë¦¬ì ëŒ€ë¦¬ ì¡°íšŒ</span>
                </div>
            </div>
        </div>
        
        <div class="admin-main-content">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h4>ğŸ–¥ï¸ íƒ€ì„(ë£¸) í˜„í™©</h4>
                    <div class="mt-2">
                        <span class="badge bg-success me-2">ìœ íš¨: {{ valid_bays_count }}ê°œ</span>
                        <span class="badge bg-warning me-2">ë¬´íš¨: {{ invalid_bays_count }}ê°œ</span>
                        <span class="badge bg-secondary">ì „ì²´: {{ total_bays_count }}ê°œ</span>
                    </div>
                </div>
            </div>
            
            <div class="admin-bay-grid">
                {% for bay in bays %}
                <div class="admin-bay-card {{ 'active' if bay.active_user else '' }} {{ 'bay-invalid' if not bay.is_valid else 'bay-valid' }}">
                    <div class="admin-bay-card-header">
                        <div class="admin-bay-number">
                            {% set bay_num = bay.bay_id|int %}
                            {{ "%02d"|format(bay_num) }}ë²ˆ íƒ€ì„(ë£¸)
                        </div>
                        <div class="admin-bay-status {{ 'active' if bay.active_user else 'ready' }}">
                            {{ 'ë¡œê·¸ì¸ ì¤‘' if bay.active_user else 'ë¹„ì–´ ìˆìŒ' }}
                        </div>
                    </div>
                    
                    {% if bay.is_valid %}
                    <div class="mt-2">
                        <span class="badge bg-success">âœ“ ìœ íš¨</span>
                        {% if bay.pc_name %}
                        <small class="text-muted d-block mt-1">{{ bay.pc_name }}</small>
                        {% endif %}
                    </div>
                    {% elif bay.has_pc %}
                    <div class="mt-2">
                        <span class="badge bg-warning">âš  ë¬´íš¨</span>
                        {% if bay.pc_name %}
                        <small class="text-muted d-block mt-1">{{ bay.pc_name }}</small>
                        {% endif %}
                        <small class="text-danger d-block mt-1">
                            {% if bay.pc_status == 'pending' %}ìŠ¹ì¸ ëŒ€ê¸° ì¤‘
                            {% elif bay.pc_status == 'rejected' %}ìŠ¹ì¸ ê±°ë¶€ë¨
                            {% else %}ì‚¬ìš© ê¸°ê°„ ë§Œë£Œ
                            {% endif %}
                        </small>
                    </div>
                    {% else %}
                    <div class="mt-2">
                        <span class="badge bg-secondary">íƒ€ì„(ë£¸) ë¯¸ë“±ë¡</span>
                    </div>
                    {% endif %}
                    
                    {% if bay.active_user %}
                    <div class="mt-2">
                        <strong>{{ bay.active_user }} ë‹˜</strong><br>
                        <small class="text-muted">ë¡œê·¸ì¸: {{ bay.login_time.split(' ')[1] if bay.login_time else '' }}</small>
                    </div>
                    {% else %}
                    <div class="mt-2 text-muted">ëŒ€ê¸° ì¤‘...</div>
                    {% endif %}
                    
                    <div class="mt-2">
                        <a href="{{ url_for('bay_shots', store_id=store_id, bay_id=bay.bay_id) }}" 
                           class="admin-btn admin-btn-primary btn-sm">
                            ìƒ· ê¸°ë¡ ë³´ê¸°
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            <div class="mt-4">
                <h4>ğŸ“Š ì „ì²´ ìƒ· ê¸°ë¡</h4>
                {% if shots %}
                <div class="table-responsive">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ì‹œê°„</th>
                                <th>íƒ€ì„</th>
                                <th>ì‚¬ìš©ì</th>
                                <th>í´ëŸ½</th>
                                <th>ì´ê±°ë¦¬</th>
                                <th>ìºë¦¬</th>
                                <th>ìŠ¤ë§¤ì‹œíŒ©í„°</th>
                                <th>ë³¼ìŠ¤í”¼ë“œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for s in shots[:20] %}
                            <tr>
                                <td>{{ s.timestamp.split(' ')[1] if s.timestamp else "" }}</td>
                                <td>
                                    {% set bay_num = s.bay_id|int %}
                                    {{ "%02d"|format(bay_num) }}ë²ˆ íƒ€ì„
                                </td>
                                <td>{{ "ê²ŒìŠ¤íŠ¸" if s.user_id == "GUEST" else s.user_id }}</td>
                                <td>{{ s.club_id }}</td>
                                <td>{{ "%.1f"|format(s.total_distance) if s.total_distance is not none else "" }}</td>
                                <td>{{ "%.1f"|format(s.carry) if s.carry is not none else "" }}</td>
                                <td>{{ "%.2f"|format(s.smash_factor) if s.smash_factor is not none else "" }}</td>
                                <td>{{ "%.2f"|format(s.ball_speed) if s.ball_speed is not none else "" }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <p class="text-muted">ì•„ì§ ìƒ· ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                {% endif %}
            </div>
        </div>
    </div>
</body>
</html>
