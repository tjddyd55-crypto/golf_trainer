<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§¤ì¥ ê´€ë¦¬ - Golf Trainer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/super_admin.css') }}">
</head>
<body>
    <div class="super-container">
        <div class="super-header">
            <h1 class="text-white mb-0">ğŸ¢ ë§¤ì¥ ê´€ë¦¬</h1>
        </div>
        
        <div class="super-main-content">
            <div class="mb-3 d-flex justify-content-between align-items-center">
                <a href="{{ url_for('super_admin_dashboard') }}" class="super-btn super-btn-secondary">â† ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°</a>
                <div>
                    <label for="store-select" class="me-2">ë§¤ì¥ ì„ íƒ:</label>
                    <select id="store-select" class="form-select d-inline-block" style="width: auto;" onchange="location.href=this.value ? '{{ url_for('store_bays_detail', store_id='') }}' + this.value : '{{ url_for('manage_stores') }}'">
                        <option value="">ì „ì²´ ë§¤ì¥</option>
                        {% for store in stores %}
                        <option value="{{ store.store_id }}" {% if request.args.get('store_id') == store.store_id %}selected{% endif %}>
                            {{ store.store_name or store.store_id }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            
            <div class="table-responsive">
                <table class="super-table">
                    <thead>
                        <tr>
                            <th>ë§¤ì¥ ì½”ë“œ</th>
                            <th>ë§¤ì¥ ì´ë¦„</th>
                            <th>íƒ€ì„(ë£¸)</th>
                            <th>êµ¬ë… ìƒíƒœ</th>
                            <th>ì‹œì‘ì¼</th>
                            <th>ì¢…ë£Œì¼</th>
                            <th>ì‘ì—…</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for store in stores %}
                        <tr>
                            <td>{{ store.store_id }}</td>
                            <td>{{ store.store_name or '-' }}</td>
                            <td>
                                <a href="{{ url_for('store_bays_detail', store_id=store.store_id) }}" 
                                   class="text-decoration-none">
                                    ì´ íƒ€ì„ìˆ˜: {{ store.valid_bays_count }}/{{ store.total_bays_count }}
                                </a>
                            </td>
                            <td>
                                <span class="super-store-status {{ store.subscription_status or 'active' }}">
                                    {{ store.subscription_status or 'active' }}
                                </span>
                            </td>
                            <td>{{ store.subscription_start_date or '-' }}</td>
                            <td>{{ store.subscription_end_date or '-' }}</td>
                            <td>
                                <a href="{{ url_for('store_bays_detail', store_id=store.store_id) }}" 
                                   class="super-btn super-btn-primary btn-sm">
                                    íƒ€ì„ í˜„í™© ë³´ê¸°
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <script>
        function extendSubscription(storeId, months) {
            if (confirm(`${months}ê°œì›” êµ¬ë…ì„ ì—°ì¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                fetch('{{ url_for("extend_subscription") }}', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({store_id: storeId, months: months})
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert(`êµ¬ë…ì´ ${data.new_end_date}ê¹Œì§€ ì—°ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                        location.reload();
                    }
                });
            }
        }
    </script>
</body>
</html>
